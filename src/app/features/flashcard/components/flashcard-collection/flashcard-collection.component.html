<div class="collection-layout">
  <!-- Sidenav for Filters -->
  <aside class="sidenav">
    <app-accordion label="Card Types">
      <button mat-icon-button [routerLink]="['/', 'editor']" class="action">
        <mat-icon>add</mat-icon>
      </button>
      <mat-selection-list>
        @for (model of models$ | async; track model.name) {
        <mat-list-option
          (selectedChange)="onModelFilterChange($event, model.id)"
          [value]="model.id"
          togglePosition="before"
          >{{ model.name }}</mat-list-option
        >
        }
      </mat-selection-list>
    </app-accordion>
  </aside>

  <!-- Main Content -->
  <main class="main-content">
    <div class="toolbar">
      <mat-button-toggle-group class="view-toggle">
        <button
          (click)="toggleViewMode('grid')"
          mat-button
          [class.active]="(viewMode$ | async) === 'grid'"
        >
          Grid
        </button>
        <button
          (click)="toggleViewMode('list')"
          mat-button
          [class.active]="(viewMode$ | async) === 'list'"
        >
          List
        </button>
      </mat-button-toggle-group>
      <div class="spacer"></div>
      <button mat-button (click)="toggleHeaders()">
        <mat-icon>{{ showHeaders ? "toggle_on" : "toggle_off" }}</mat-icon>
        Actions
      </button>
      <button mat-button [routerLink]="['/flashcard/review']">
        <mat-icon>school</mat-icon>
        Review
      </button>
      <button mat-flat-button [routerLink]="['/flashcard/create']">
        <mat-icon>add</mat-icon>
        Create
      </button>
    </div>

    @let viewMode = viewMode$ | async;
    <div class="card-area" [ngClass]="viewMode">
      <div *ngFor="let item of displayedCards$ | async" class="card-wrapper">
        <app-flashcard
          [ngClass]="{ withHeader: showHeaders }"
          [model]="item.model"
          [data]="item"
        />
        @if (showHeaders) {
        <mat-toolbar class="card-header">
          <div class="spacer"></div>
          <button mat-icon-button (click)="addToReview(item)">
            <mat-icon>add</mat-icon>
          </button>
        </mat-toolbar>
        }
      </div>
    </div>
  </main>
</div>
